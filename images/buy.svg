<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="487px" preserveAspectRatio="none" style="width:419px;height:487px;background:#FFFFFF;" version="1.1" viewBox="0 0 419 487" width="419px" zoomAndPan="magnify"><defs><filter height="300%" id="fu5medq1b18ro" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="79" x="168.25" y="28.708">Buy USN</text><rect fill="#FFFFFF" filter="url(#fu5medq1b18ro)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="288.5" y="180.9141"/><rect fill="#FFFFFF" filter="url(#fu5medq1b18ro)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="280" x="125.5" y="380.5781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="29" x2="29" y1="75.25" y2="443.8438"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="157.5" x2="157.5" y1="75.25" y2="443.8438"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="293.5" x2="293.5" y1="75.25" y2="443.8438"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="372.5" x2="372.5" y1="75.25" y2="443.8438"/><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="12" y="59.9482">alice</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="45" x="5" y="442.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="12" y="462.8389">alice</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="40" x="135.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="142.5" y="59.9482">usn</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="40" x="135.5" y="442.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="142.5" y="462.8389">usn</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="90" x="246.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="253.5" y="59.9482">priceoracle</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="90" x="246.5" y="442.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="253.5" y="462.8389">priceoracle</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="41" x="350.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="357.5" y="59.9482">bob</text><rect fill="#FEFECE" filter="url(#fu5medq1b18ro)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="41" x="350.5" y="442.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="357.5" y="462.8389">bob</text><rect fill="#FFFFFF" filter="url(#fu5medq1b18ro)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="288.5" y="180.9141"/><polygon fill="#A80036" points="145.5,147.7813,155.5,151.7813,145.5,155.7813,149.5,151.7813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="29.5" x2="151.5" y1="151.7813" y2="151.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="36.5" y="101.3169">send NEAR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="36.5" y="116.4497">+ expected rate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="36.5" y="131.5825">+ slippage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="36.5" y="146.7153">+ transfer to</text><polygon fill="#A80036" points="276.5,176.9141,286.5,180.9141,276.5,184.9141,280.5,180.9141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="282.5" y1="180.9141" y2="180.9141"/><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="112" x="164.5" y="175.8481">get_price_data</text><polygon fill="#A80036" points="168.5,206.0469,158.5,210.0469,168.5,214.0469,164.5,210.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="162.5" x2="292.5" y1="210.0469" y2="210.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="174.5" y="204.981">NEAR/USDT rate</text><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="199.5" y1="239.1797" y2="239.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="199.5" x2="199.5" y1="239.1797" y2="252.1797"/><line style="stroke:#A80036;stroke-width:1.0;" x1="158.5" x2="199.5" y1="252.1797" y2="252.1797"/><polygon fill="#A80036" points="168.5,248.1797,158.5,252.1797,168.5,256.1797,164.5,252.1797" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108" x="164.5" y="234.1138">verify timestamp</text><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="199.5" y1="281.3125" y2="281.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="199.5" x2="199.5" y1="281.3125" y2="294.3125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="158.5" x2="199.5" y1="294.3125" y2="294.3125"/><polygon fill="#A80036" points="168.5,290.3125,158.5,294.3125,168.5,298.3125,164.5,294.3125" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="164.5" y="276.2466">assert slippage</text><line style="stroke:#A80036;stroke-width:1.0;" x1="157.5" x2="199.5" y1="323.4453" y2="323.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="199.5" x2="199.5" y1="323.4453" y2="336.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="158.5" x2="199.5" y1="336.4453" y2="336.4453"/><polygon fill="#A80036" points="168.5,332.4453,158.5,336.4453,168.5,340.4453,164.5,336.4453" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="164.5" y="318.3794">mint USN</text><polygon fill="#A80036" points="40.5,361.5781,30.5,365.5781,40.5,369.5781,36.5,365.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="34.5" x2="156.5" y1="365.5781" y2="365.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="46.5" y="360.5122">USN amount</text><path d="M125.5,380.5781 L189.5,380.5781 L189.5,387.5781 L179.5,397.5781 L125.5,397.5781 L125.5,380.5781 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="280" x="125.5" y="380.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="140.5" y="393.645">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="171" x="204.5" y="392.7886">[If "transfer to" is defined]</text><polygon fill="#A80036" points="361,414.8438,371,418.8438,361,422.8438,365,418.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157.5" x2="367" y1="418.8438" y2="418.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="164.5" y="413.7778">USN amount</text><!--MD5=[9a947e723b9ee5a4d81a71cb88f0af9c]
@startuml

title Buy USN

alice -> usn: send NEAR\n+ expected rate\n+ slippage\n+ transfer to

usn -> priceoracle: ""get_price_data""
activate priceoracle
usn <- priceoracle: NEAR/USDT rate
deactivate priceoracle
usn -> usn: verify timestamp

usn -> usn: assert slippage
usn -> usn: mint USN

alice <- - usn: USN amount
alt If "transfer to" is defined
bob <- - usn: USN amount
end
@enduml

PlantUML version 1.2022.0(Tue Jan 11 18:16:42 EET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>